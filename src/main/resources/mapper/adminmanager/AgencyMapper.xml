<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mtf.admin.mapper.adminmanager.AgencyMapper">

    <select id="findOne" resultType="com.mtf.admin.entity.Agency">
        SELECT
            *
        FROM
            agency
        WHERE
            id = #{id}
    </select>

    <select id="findOneByLoginKeyAndLoginPwd" resultType="com.mtf.admin.entity.Agency">
        SELECT
        *
        FROM
        agency

        <where>
          deleted = 0
          <if test="loginKey != null">
              AND login_name = #{loginKey}
          </if>
            <if test="loginPwd != null">
                AND password = #{loginPwd}
            </if>
        </where>

    </select>

    <insert id="save" parameterType="com.mtf.admin.entity.Agency" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO
            Agency(
                agency_type,
                parent_id,
                parent_nickname,
                password,
                nickname,
                avatar,
                phone,
                room_card,
                coin,
                agency_balance,
                salary_balance,
                disable,
                deleted,
                create_date,
                creator_id,
                user_id
            )
        VALUES (
                #{agencyType},
                #{parentId},
                #{parentNickname},
                #{password},
                #{nickname},
                #{avatar},
                #{phone},
                #{roomCard},
                #{coin},
                #{agencyBalance},
                #{salaryBalance},
                #{disable},
                #{deleted},
                #{createDate},
                #{creatorId},
                #{userId}
                )
    </insert>

    <select id="findByParentId" resultType="com.mtf.admin.entity.Agency">
        SELECT
            *
        FROM
            Agency
        WHERE
            parent_id = #{parentId}
    </select>

</mapper>